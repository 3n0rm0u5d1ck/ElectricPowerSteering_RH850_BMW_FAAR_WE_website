---
layout: default
title: SysTimeClassic_IntegrationManual
nav_order: 2
parent: SysTime
---
{% raw %}
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
     "http://www.w3.org/TR/html4/transitional.dtd">
<html>
<head>

  <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
  <title></title>
  <meta name="generator" content="LibreOffice 24.2.7.2 (Linux)"/>
  <meta name="created" content="00:00:00"/>
  <meta name="changed" content="00:00:00"/>
</head>
<body>
<h1></h1>
<p>SysTime Classic Integration Manual</p>
<p>Project</p>
<p>BMW AUTOSAR 4 Core Rel. 3</p>
<p>Author</p>
<p>BMW AG</p>
<p>Release Date</p>
<p>2017-12-14</p>
<p>Version</p>
<p>5.0.3</p>
<p>Status</p>
<p>Release</p>
<p>Hotline</p>
<p>+49 89 382 - 32233</p>
<p>Contact</p>
<p>bac@bmw.de</p>
<p>https://asc.bmw.com/jira/browse/BSUP (extern)</p>
<p>https://asc.bmwgroup.net/jira/browse/BSUP (intern)</p>
<p><b>Company</b></p>
<p>Bayerische</p>
<p>Motoren Werke</p>
<p>Aktiengesellschaft</p>
<p><b>Postal address</b></p>
<p>BMW AG</p>
<p>80788 München</p>
<p><b>Office address</b></p>
<p>Forschungs- und</p>
<p>Innovationszentrum</p>
<p>(FIZ)</p>
<p>Hufelandstr. 1</p>
<p>80937 München</p>
<p><b>Telephone</b></p>
<p>Switchboard</p>
<p>+49 89 382-0</p>
<p><b>Internet</b></p>
<p>www.bmwgroup.com</p>
<p>Revision History</p>
<p><b>Version</b></p>
<p><b>Date</b></p>
<p><b>Description</b></p>
<p>5.0.3</p>
<p>2017-12-14</p>
<p>Version Update</p>
<p>5.0.2</p>
<p>2017-10-12</p>
<p>Version Update</p>
<p>5.0.1</p>
<p>2017-08-10</p>
<p>Version update, no change of content.</p>
<p>5.0.0</p>
<p>2017-06-08</p>
<p>Initial version for SP2021</p>
<p>SysTimeClassic_IntegrationManual.pdf, Version 5.0.3, Software Platforms</p>
<p>Page 1 of 11</p>
<h1 style="page-break-before:always; "></h1>
<p><b>Table of Contents</b></p>
<p><b>1</b></p>
<p><b>Introduction</b></p>
<p><b>3</b></p>
<p>1.1</p>
<p>Functional overview</p>
<p>3</p>
<p><b>2</b></p>
<p><b>Related documentation</b></p>
<p><b>4</b></p>
<p><b>3</b></p>
<p><b>Limitations</b></p>
<p><b>5</b></p>
<p><b>4</b></p>
<p><b>Software Architecture</b></p>
<p><b>6</b></p>
<p>4.1</p>
<p>Dependencies on AUTOSAR modules</p>
<p>6</p>
<p>4.1.1</p>
<p>RTE</p>
<p>6</p>
<p>4.1.2</p>
<p>Det</p>
<p>6</p>
<p>4.1.3</p>
<p>Dcm</p>
<p>6</p>
<p>4.1.4</p>
<p>Dem</p>
<p>6</p>
<p>4.1.5</p>
<p>Com</p>
<p>6</p>
<p>4.1.6</p>
<p>BswM</p>
<p>6</p>
<p>4.2</p>
<p>Dependencies to other modules</p>
<p>6</p>
<p><b>5</b></p>
<p><b>Integration</b></p>
<p><b>7</b></p>
<p>5.1</p>
<p>Configuration of other Modules</p>
<p>7</p>
<p>5.1.1</p>
<p>Dcm</p>
<p>7</p>
<p>5.1.2</p>
<p>Com</p>
<p>7</p>
<p>5.1.3</p>
<p>Dem</p>
<p>7</p>
<p>5.1.4</p>
<p>BswM</p>
<p>8</p>
<p>5.1.5</p>
<p>Det</p>
<p>8</p>
<p>5.2</p>
<p>Configuration of generic part</p>
<p>8</p>
<p>5.2.1</p>
<p>SysTimeGeneral</p>
<p>8</p>
<p>5.2.1.1</p>
<p>SysTimeDevErrorDetect</p>
<p>8</p>
<p>5.2.1.2</p>
<p>SysTimeMainTaskCycle</p>
<p>9</p>
<p>5.2.1.3</p>
<p>SysTimeInitialTimeout</p>
<p>9</p>
<p>5.3</p>
<p>Configuration of adapter part</p>
<p>9</p>
<p>5.3.1</p>
<p>SysTimeGeneral</p>
<p>9</p>
<p>5.3.1.1</p>
<p>SysTimeEnableServiceInterface</p>
<p>9</p>
<p>5.4</p>
<p>Configuration of the RTE</p>
<p>9</p>
<p>5.4.1</p>
<p>Assembly Software Connectors</p>
<p>9</p>
<p>5.4.1.1</p>
<p>Dcm</p>
<p>10</p>
<p>5.4.1.2</p>
<p>Dem</p>
<p>10</p>
<p>5.4.1.3</p>
<p>Det</p>
<p>10</p>
<p>5.4.1.4</p>
<p>BswM</p>
<p>10</p>
<p>5.4.1.5</p>
<p>Other Application SWC</p>
<p>10</p>
<p>5.4.2</p>
<p>Event Mapping</p>
<p>10</p>
<p>5.4.3</p>
<p>Data Mapping</p>
<p>10</p>
<p>5.4.4</p>
<p>Exclusive Areas</p>
<p>11</p>
<p>5.5</p>
<p>Software Integration</p>
<p>11</p>
<p>5.5.1</p>
<p>Startup/Initialization</p>
<p>11</p>
<p>5.5.2</p>
<p>Normal Operation</p>
<p>11</p>
<p>5.5.3</p>
<p>Shutdown/Deactivation</p>
<p>11</p>
<p>5.5.4</p>
<p>SWCD</p>
<p>11</p>
<p>SysTimeClassic_IntegrationManual.pdf, Version 5.0.3, Software Platforms</p>
<p>Page 2 of 11</p>
<h1 style="page-break-before:always; "></h1>
<p><b>1</b></p>
<p><b>Introduction</b></p>
<p>This Integration Manual describes the basic functionality of the BMW system function &quot;System Time</p>
<p>Client&quot;, the configuration of the SysTime module and of dependant modules, and the integration of the</p>
<p>SysTime module into the BAC4.</p>
<p><b>[IM_SysTime_0001]<i></b> d</i>The SysTime module shall be integrated in every diagnosable ECU.</p>
<p><i>c</i>(DMA_PA_9033)</p>
<p><b>Functional overview</b></p>
<p>The system time represents the time, which has passed since the initialization of the System Time</p>
<p>Master. The main objective of the System Time Client functionality is to maintain the current system time</p>
<p>for the local ECU. This means:</p>
<p>Receiving the system time from the System Time Master</p>
<p>Interpolation of the system time if no system time signal was received from the System Time Master</p>
<p>Providing the system time to the Dem and to other software components</p>
<p>Providing the system time for diagnostic requests</p>
<p>SysTimeClassic_IntegrationManual.pdf, Version 5.0.3, Software Platforms</p>
<p>Page 3 of 11</p>
<h1 style="page-break-before:always; "></h1>
<p><b>2</b></p>
<p><b>Related documentation</b></p>
<p><b>References</b></p>
<p>SysTimeClassic_IntegrationManual.pdf, Version 5.0.3, Software Platforms</p>
<p>Page 4 of 11</p>
<h1 style="page-break-before:always; "></h1>
<p><b>3</b></p>
<p><b>Limitations</b></p>
<p>No limitations are known.</p>
<p>SysTimeClassic_IntegrationManual.pdf, Version 5.0.3, Software Platforms</p>
<p>Page 5 of 11</p>
<h1 style="page-break-before:always; "></h1>
<p><b>4</b></p>
<p><b>Software Architecture</b></p>
<p><b>Dependencies on AUTOSAR modules</b></p>
<p>The current version of the Module SysTime depends on the following BSW modules:</p>
<p><b>RTE</b></p>
<p>As a software component, the SysTime module uses Rte client/server communication as well as</p>
<p>sender/receiver communication to communicate with other SWCs and BSW modules. Additionally the</p>
<p>scheduling is done by the Rte.</p>
<p><b>Det</b></p>
<p>The System Time Client optionally reports development errors to the Det.</p>
<p><b>Dcm</b></p>
<p>The System Time Client implements a ReadDataByIdentifier service. Dcm shall be configured in a way,</p>
<p>that it dispatches the job 0x22 0x17 0x01 to the SysTime SWC.</p>
<p><b>Dem</b></p>
<p>The System Time Client provides a port interface for the Dem to get the current system time, which will</p>
<p>be attached to an event as event related data.</p>
<p><b>Com</b></p>
<p>The System Time Client receives the signal containing the current system time from the Com module.</p>
<p><b>BswM</b></p>
<p>The System Time Client receives and requests mode switches from the BswM.</p>
<p><b>Dependencies to other modules</b></p>
<p>SysTime does not have dependencies to other modules.</p>
<p>SysTimeClassic_IntegrationManual.pdf, Version 5.0.3, Software Platforms</p>
<p>Page 6 of 11</p>
<h1 style="page-break-before:always; "></h1>
<p><b>5</b></p>
<p><b>Integration</b></p>
<p><b>Configuration of other Modules</b></p>
<p>The following modules shall be configured, before this module can be generated, compiled and linked.</p>
<p><b>Dcm</b></p>
<p><b>[IM_SysTimeClassic_0003]<i></b> d</i>The ReadDataByIdentifier request 0x22 0x17 0x01 shall be configured</p>
<p>in the Dcm module with the following settings:</p>
<p>a container &quot;DcmDspData&quot; with</p>
<p>a &quot;DcmDspDataSize&quot; of 32 bit (4 bytes)</p>
<p>&quot;DcmDspDataType&quot; =</p>
<p>UINT8</p>
<p><i>N</i></p>
<p>”<i>DcmDspDataUseP ort</i>” =<i> USE</i>_<i>DAT A</i>_<i>SY NCH</i>_<i>CLIENT</i> _<i>SERV ER</i></p>
<p>&quot;DcmDspDataConditionCheckReadFncUsed&quot; = FALSE</p>
<p>a container &quot;DcmDspDid&quot; with</p>
<p>&quot;DcmDspDidIdentifier&quot; = 0x1701</p>
<p>only read-access, without session or security restrictions</p>
<p>one DID Signal &quot;DcmDspDidSignal&quot; with Data Position = 0 and a Data Reference to the</p>
<p>&quot;DcmDspData&quot; container configured before.</p>
<p><i>c</i>(DMA_PA_8550, DMA_PA_8551, DMA_PA_8552)</p>
<p><b>Com</b></p>
<p>In the Com module, a signal has to be configured, that receives the message containing the 32-bit</p>
<p>system time from the bus.</p>
<p><b>Note</b>: In a Can or FlexRay environment, the system time is received within the signal named</p>
<p>T_SEC_COU_REL. In an Ethernet environment, the system time is received within the Parameter</p>
<p>&quot;timeSecondCounterRelative&quot; of the Event &quot;RelativeTimeBN2020&quot;.</p>
<p><b>Dem</b></p>
<p><b>[IM_SysTimeClassic_0006]<i></b> d</i>To attach the system time to a freeze frame of a Dem entry, the</p>
<p>following has to be configured in the Dem module:</p>
<p>a Data Element Class &quot;DemDataElementClass&quot;</p>
<p>of type &quot;DemExternalCSDataElementClass&quot;</p>
<p>with a size &quot;DemDataElementDataSize&quot; of 4 byte</p>
<p>with port usage &quot;DemDataElementUsePort&quot; = TRUE</p>
<p>a Data Id &quot;DemDidClass&quot; with reference to the Data Element Class mentioned above</p>
<p>with reference to the Data Element Class mentioned above</p>
<p>with &quot;DemDidIdentifier&quot; = 0x1701</p>
<p>SysTimeClassic_IntegrationManual.pdf, Version 5.0.3, Software Platforms</p>
<p>Page 7 of 11</p>
<h1 style="page-break-before:always; "></h1>
<p>a Freeze Frame Class &quot;DemFreezeFrameClass&quot; with reference to the Data Id above</p>
<p>This DemFreezeFrameClass has to be referenced in the &quot;DemDTCAttributes&quot; of every DTC.</p>
<p><i>c</i>(DK_T3_1374, DK_T3_452, DK_T3_453)</p>
<p><b>BswM</b></p>
<p>The BswM has to provide one BswMModeRequestPort to receive mode switches of the</p>
<p>ModeDeclarationGroup &quot;SysTime_LifeCycle&quot; from the SysTime module, and one RteModeRequestPort</p>
<p>to request modes of the ModeDeclarationGroup &quot;SysTime_LifeCycle&quot;.</p>
<p>To initialize the SysTime module the BswM has to provide a rule, that results in an action that requests</p>
<p>the mode &quot;SYSTIME_INITIALIZED&quot;of the mode declaration group &quot;SysTime_LifeCycle&quot;.</p>
<p>To set the SysTime module to normal operation mode the BswM has to provide a rule, that results in an</p>
<p>action that requests the mode &quot;SYSTIME_RUNNING&quot; of the mode declaration group</p>
<p>&quot;SysTime_LifeCycle&quot;. This rule shall be triggered, if the mode has been switched to</p>
<p>&quot;SYSTIME_INITIALIZED&quot; by the SysTime module itself, AND it is technically possible to receive the</p>
<p>system time on the bus. When the SysTime module is in normal operation mode, the SysTime module</p>
<p>switches the mode to &quot;SYSTIME_RUNNING&quot;.</p>
<p>To deactivate the SysTime module the BswM has to provide a rule, that results in an action that requests</p>
<p>the mode &quot;SYSTIME_STOPPED&quot; of the mode declaration group &quot;SysTime_LifeCycle&quot;.</p>
<p>For details on how to initialize / deactivate the SysTime module, please refer to chapter 6.4.</p>
<p><b>Det</b></p>
<p>A SysTime entry shall be added to the Software Component List from Det. This is only necessary, if the</p>
<p>parameter &quot;SysTimeDevErrorDetect&quot; is set to &quot;true&quot; (see chapter 6.2).</p>
<p><b>Configuration of generic part</b></p>
<p><b>SysTimeGeneral</b></p>
<p>This container contains the configuration parameters of the generic part of the SysTime module</p>
<p><b>SysTimeDevErrorDetect</b></p>
<p>This parameter activates/deactivates the Development Error Detection and Notification.</p>
<p>If set to true: Development Error Detection and Notification is activated. If set to false: Development Error</p>
<p>Detection and Notification is deactivated.</p>
<p>SysTimeClassic_IntegrationManual.pdf, Version 5.0.3, Software Platforms</p>
<p>Page 8 of 11</p>
<h1 style="page-break-before:always; "></h1>
<p><b>SysTimeMainTaskCycle</b></p>
<p>This parameter describes the cycle rate, in which the function &quot;SysTime_MainFunction&quot; is called. This</p>
<p>value has to be configured according to the cycle time of the task, which the Timing Event &quot;TimingEvent&quot;</p>
<p>is mapped to (see chapter 6.3.1). Allowed values are 0.01s (10ms) to 0.10s (100ms).</p>
<p>The function &quot;SysTime_MainFunction&quot; is mapped to the Runnable Entity &quot;MainFunction&quot;, which is</p>
<p>triggered by the Timing Event &quot;TimingEvent&quot;.</p>
<p><b>SysTimeInitialTimeout</b></p>
<p><b>[IM_SysTime_0002]<i></b> d</i>This parameter describes the initial timeout value for the system time signal. The</p>
<p>System Time Client will set the system time to 0xFFFFFFFF, if no valid system time has been received</p>
<p>until this timeout has expired. If the system time signal is received via Can, FlexRay or Ethernet, this</p>
<p>parameter has to be set to 5.0 seconds.<i> c</i>(DMA_PA_8471)</p>
<p><b>Configuration of adapter part</b></p>
<p><b>SysTimeGeneral</b></p>
<p>This container contains the configuration parameters of the classic adapter of the SysTime module.</p>
<p><b>SysTimeEnableServiceInterface</b></p>
<p>This parameter describes whether the system time is received via Service Interface or via a plain signal.</p>
<p>On Ethernet the system time is transmitted via Parameter &quot;timeSecondCounterRelative&quot; of Event</p>
<p>&quot;RelativeTimeBN2020&quot; of Service Interface &quot;VehicleInformation&quot;. On Can and Flexray the system time is</p>
<p>transmitted via Signal T_SEC_COU_REL.</p>
<p>true: system time is received via Service Interface (needed for Ethernet communication)</p>
<p>false: System time is received via plain signal (needed for Can and Flexray communication)</p>
<p><b>Configuration of the RTE</b></p>
<p>After performing the steps indicated in chapter 6.1 and 6.2, the RTE configuration can be started. In other</p>
<p>way, the RTE will report an interface incompatibility error.</p>
<p><b>Assembly Software Connectors</b></p>
<p>The ports of the SysTime module have to be connected with ports of other modules as follows:</p>
<p>SysTimeClassic_IntegrationManual.pdf, Version 5.0.3, Software Platforms</p>
<p>Page 9 of 11</p>
<h1 style="page-break-before:always; "></h1>
<p><b>Dcm</b></p>
<p><b>[IM_SysTimeClassic_0002]<i></b> d</i>SystemTime &lt;-&gt; DataServices_&lt;Data&gt; where &lt;Data&gt; is the name of</p>
<p>the corresponding container &quot;DcmDspData&quot; configured in the Dcm module.<i> c</i>(DMA_PA_8552)</p>
<p><b>Dem</b></p>
<p><b>[IM_SysTimeClassic_0007]<i></b> d</i>SystemTime &lt;-&gt; CBReadData_&lt;SyncDataElement&gt; where</p>
<p>&lt;SyncDataElement&gt; is the name of the corresponding container &quot;DemDataElementClass&quot; configured in</p>
<p>the Dem module.<i> c</i>(DK_T3_1374)</p>
<p><b>Det</b></p>
<p>SysTimeReportError &lt;-&gt; DS&lt;xxx&gt; where &lt;xxx&gt; is an identifier of the module id of the SysTime</p>
<p>configured in the Det module.</p>
<p><b>BswM</b></p>
<p>LifeCycle &lt;-&gt; BswMModeRequestPort_xxx where BswMModeRequestPort_xxx means the R-Port of the</p>
<p>BswM that receives a mode switch from the SysTime module. LifeCycleRequest &lt;-&gt;</p>
<p>RteModeRequestPort_xxx where RteModeRequestPort_xxx means the P-Port of the BswM that provides</p>
<p>a mode request to the SysTime module.</p>
<p><b>Other Application SWC</b></p>
<p>SysTime &lt;-&gt; ApplicationPort where ApplicationPort means the R-Port of an Application SWC that wants</p>
<p>to read the current system time from the SysTime module.</p>
<p><b>Event Mapping</b></p>
<p>The timing event &quot;TimingEvent&quot; of the SysTime module has to be mapped to a cyclic task with a cycle</p>
<p>time according to parameter &quot;SysTimeMainTaskCycle&quot; in chapter 6.2. The data received event</p>
<p>&quot;SysTimeRx&quot; has to be mapped to an os-task.</p>
<p><b>Data Mapping</b></p>
<p><b>[IM_SysTimeClassic_0001]<i></b> d</i>If the system time is received via Can or FlexRay, the data element</p>
<p>&quot;timeSignal&quot; of the sender-receiver-interface &quot;SysTimeRx&quot; has to be mapped to the signal in the Com</p>
<p>configuration mentioned in chapter 6.1. In the BNE export this signal is named T_SEC_COU_REL.</p>
<p><i>c</i>(DMA_PA_8471)</p>
<p>SysTimeClassic_IntegrationManual.pdf, Version 5.0.3, Software Platforms</p>
<p>Page 10 of 11</p>
<h1 style="page-break-before:always; "></h1>
<p>If the system time is received via Ethernet, the data element &quot;RelativeTimeBN2020&quot; of the</p>
<p>sender-receiver-interface &quot;SysTimeEventRx&quot; has to be mapped to the signal group in the Com</p>
<p>configuration, which represents the Event &quot;RelativeTimeBN2020&quot;.</p>
<p><b>Exclusive Areas</b></p>
<p>The exclusive area &quot;SysTimeGetTimeArea&quot; has to be configured in the RTE.</p>
<p><b>Software Integration</b></p>
<p><b>Startup/Initialization</b></p>
<p>Before initialization of the SysTime module, the Det module and the RTE have to be initialized.</p>
<p><b>[IM_SysTimeClassic_0004]<i></b> d</i>To initialize the SysTime module, the BswM shall request the mode</p>
<p>&quot;SYSTIME_INITIALIZED&quot; of the mode declaration group &quot;SysTime_LifeCycle&quot;. This shall be done before</p>
<p>any monitoring function is active which could lead to error memory entries.<i> c</i>(DMA_PA_8300)</p>
<p>When initialization of the SysTime has been finished successfully, the SysTime module switches the</p>
<p>mode to &quot;SYSTIME_INITIALIZED&quot;.</p>
<p><b>Normal Operation</b></p>
<p>When the SysTime module switches the mode to &quot;SYSTIME_INITIALIZED&quot;, AND it is technically</p>
<p>possible to receive the system time on the bus, the BswM shall request the mode</p>
<p>&quot;SYSTIME_RUNNING&quot;. When the SysTime module switches the mode to &quot;SYSTIME_RUNNING&quot;, the</p>
<p>module is in normal operation mode.</p>
<p><b>Shutdown/Deactivation</b></p>
<p><b>[IM_SysTimeClassic_0005]<i></b> d</i>To deactivate the SysTime module, the BswM has to request the mode</p>
<p>&quot;SYSTIME_STOPPED&quot;. When the SysTime module switches the mode to &quot;SYSTIME_STOPPED&quot;, the</p>
<p>module is deactivated. This shall not be done as long as any monitoring function is active which could</p>
<p>lead to error memory entries.<i> c</i>(DMA_PA_8300)</p>
<p><b>SWCD</b></p>
<p>If the modules Dem and Dcm are configured correctly, there should be no changes necessary in the file</p>
<p>SysTime_ext_interfaces.arxml. If the RTE importer complains about incompatible interfaces, please</p>
<p>check the Dem and Dcm configuration, or adapt the interfaces in SysTime_ext_interfaces.arxml according</p>
<p>to the generated Software Component Description files of Dcm and Dem.</p>
<p>SysTimeClassic_IntegrationManual.pdf, Version 5.0.3, Software Platforms</p>
<p>Page 11 of 11</p>
</body>
</html>
{% endraw %}